"""
=============================================================================
    Eindhoven University of Technology
==============================================================================

    Source Name   : count_classes.py
                    
    Author(s)     : Tristan Stevens and Nadine Nijssen
    Date          : Sun Apr 26 16:03:00 2020

==============================================================================
"""

import torch
from train import load_data

'''device''' 
no_cuda = False
use_cuda = not no_cuda and torch.cuda.is_available()
device = torch.device('cuda:0' if use_cuda else 'cpu')
print('using device:', device)

def count_classes():
    pass

train_generator = load_data('datasets/citys', batch_size=100)['train']

n_classes = 34
class_amount = {entry: [] for entry in range(n_classes)} 

for i, (_, y) in enumerate(train_generator):
    y = (255 * y).int().to(device)    
    classes, counts = torch.unique(y, return_counts=True)
    
    for j in range(len(classes)):
        class_amount[classes[j].item()] =+ counts[j].item()
        
print(class_amount)
    
''' RESULTS
{0: 12485, 1: 6115050, 2: 5631448, 3: 2372550, 4: 1628773, 5: 485216, 6: 1755448, 7: 51402716, 8: 11105883, 9: 389448, 10: 1127135, 
11: 32944412, 12: 1404422, 13: 931716, 14: 647, 15: 1168, 16: 716904, 17: 1527438, 18: 496, 19: 249084, 20: 621830, 
1: 25239449, 22: 1365658, 23: 5223362, 24: 1690760, 25: 111354, 26: 8587667, 27: 166024, 28: 268578, 29: 338064, 30: 54641, 
31: 953315, 32: 347596, 33: 329214}
''' 
        
total = sum(class_amount.values(), 0.0)
a = {k: v / total for k, v in class_amount.items()}


''' Normalized
dict_values([7.562085830055758e-05, 0.037038472531103296, 0.03410932568962422, 0.014370385851901313, 0.009865375429457274, 0.002938922737778402, 0.010632637922466737, 0.3113430118461998, 0.06726763353188396, 0.0023588619962703686, 0.006826985672454863, 0.19954222760490098, 0.008506495559165854, 0.00564334510311272, 3.918838231514678e-06, 7.074502402487085e-06, 0.004342242354753939, 0.009251595719734646, 3.004240746261639e-06, 0.0015086860928262783, 0.003766385127515877, 0.15287375221571084, 0.008271704453746325, 0.03163757450176348, 0.01024082678255913, 0.0006744641614097147, 0.052014957896625906, 0.0010055969065672224, 0.0016267600224787468, 0.002047632346056844, 0.0003309570939848432, 0.005774168885125835, 0.002105367069430566, 0.001994028453709232])
'''